<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="data:," />
    <title>Kaspa Audio Transfer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="logo">
        <svg class="logo-icon" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
          <defs>
            <linearGradient id="katLogoG" x1="3" y1="19" x2="19" y2="3" gradientUnits="userSpaceOnUse">
              <stop stop-color="var(--kaspa-accent)" />
              <stop offset="1" stop-color="var(--kaspa-primary)" />
            </linearGradient>
          </defs>
          <path d="M11 1.6L19.2 6.4V15.6L11 20.4L2.8 15.6V6.4L11 1.6Z" stroke="url(#katLogoG)" stroke-width="1.8" stroke-linejoin="round" />
          <path d="M4.9 11H7.2L8.4 8.1L10.1 14.2L11.5 10.3L12.6 12.7H14.9" stroke="url(#katLogoG)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
        <span class="logo-text">Kaspa Audio Transfer</span>
      </div>

      <nav class="nav-links" aria-label="Primary">
        <button id="navTransfer" class="navBtn navBtnActive" type="button">Transfer</button>
        <button id="navWallet" class="navBtn" type="button">Wallet</button>
        <button id="navImport" class="navBtn" type="button">Import</button>
        <button id="navStudio" class="navBtn" type="button">Studio</button>
      </nav>

      <div class="header-actions">
        <button id="clearSessionBtn" class="btn btn-secondary" type="button">Clear session</button>
        <div class="pill headerPill">
          <span class="headerPillLabel">Status</span>
          <span id="pillText" class="headerPillValue">Ready</span>
        </div>
        <div class="pill" id="pill" style="display:none;"></div>
        <a class="btn btn-primary" href="https://github.com/liveLaughLove13" target="_blank" rel="noopener noreferrer">GitHub</a>
      </div>
    </header>

    <main class="page-content">
      <section class="hero">
        <div class="hero-copy">
          <h1 id="pageTitle">Transfer</h1>
          <p class="status" id="status">Send or receive a file using your local Kaspa node RPC.</p>
        </div>
      </section>

      <div class="error" id="error"></div>

      <div class="pages">
            <section id="pageWallet" class="page">
              <section class="card">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
          <div style="font-weight:800;">Wallet</div>
          <div class="pill" id="walletStatus">Locked</div>
        </div>

        <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:14px;">
          <div>
            <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Profile</label>
            <div style="display:flex;gap:10px;">
              <select id="walletProfileSelect" style="flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);">
                <option value="">(none)</option>
              </select>
              <button id="walletRefreshBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Refresh</button>
            </div>
          </div>

          <div>
            <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Password</label>
            <div style="display:flex;gap:10px;">
              <input id="walletPassword" type="password" autocomplete="off" spellcheck="false" style="flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
              <button id="walletUnlockBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Unlock</button>
              <button id="walletLockBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Lock</button>
            </div>
            <div style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">Unlocked profile: <span id="walletUnlocked">—</span></div>
          </div>
        </div>

        <div style="margin-top:14px;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;">
          <div class="tabs">
            <button id="walletTabOverview" class="tabBtn tabBtnActive" type="button">Overview</button>
            <button id="walletTabManage" class="tabBtn" type="button">Manage</button>
            <button id="walletTabAdvanced" class="tabBtn" type="button">Advanced</button>
          </div>
        </div>

        <div id="walletOverviewPanel" style="margin-top:14px;">
          <div class="walletGrid">
            <div class="collapseCard card walletCardAccent">
              <input id="walletBalanceCardToggle" class="collapseToggle" type="checkbox" checked />
              <div class="collapseHeader">
                <label class="collapseTitle" for="walletBalanceCardToggle">Balance</label>
                <div class="collapseActions">
                  <button id="walletBalanceRefreshBtn" style="cursor:pointer;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.20);color:var(--text);font-weight:800;">Refresh</button>
                  <label class="collapseChevron" for="walletBalanceCardToggle" aria-label="Toggle"></label>
                </div>
              </div>
              <div class="collapseBody">
                <div style="margin-top:6px;font-size:28px;font-weight:950;letter-spacing:0.01em;">
                  <span id="walletBalance">—</span>
                </div>
                <div style="margin-top:2px;font-size:14px;font-weight:900;opacity:0.95;">KAS</div>
              </div>
            </div>

            <div class="collapseCard card">
              <input id="walletAddressCardToggle" class="collapseToggle" type="checkbox" checked />
              <div class="collapseHeader">
                <label class="collapseTitle" for="walletAddressCardToggle">Address</label>
                <div class="collapseActions">
                  <button id="walletCopyAddressBtn" class="copyBtn" type="button">Copy</button>
                  <label class="collapseChevron" for="walletAddressCardToggle" aria-label="Toggle"></label>
                </div>
              </div>
              <div class="collapseBody">
                <div style="font-size:12px;color:var(--text-muted);word-break:break-all;">
                  <div><span style="opacity:0.85;">Address:</span> <span id="walletDerivedAddress">—</span></div>
                  <div style="margin-top:10px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;">
                    <div style="min-width:0;flex:1;"><span style="opacity:0.85;">Path:</span> <span id="walletFullPath">—</span></div>
                    <button id="walletCopyPathBtn" class="copyBtn" type="button">Copy</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="collapseCard card">
              <input id="walletSendCardToggle" class="collapseToggle" type="checkbox" checked />
              <div class="collapseHeader">
                <label class="collapseTitle" for="walletSendCardToggle">Send Funds</label>
                <div class="collapseActions">
                  <label class="collapseChevron" for="walletSendCardToggle" aria-label="Toggle"></label>
                </div>
              </div>
              <div class="collapseBody">
                <div style="margin-top:6px;display:flex;gap:10px;">
                  <input id="walletSendTo" type="text" placeholder="To address" spellcheck="false" style="flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                </div>
                <div id="walletSendToResolved" class="knsPreview" style="display:none;"></div>
                <div style="margin-top:10px;display:flex;gap:10px;align-items:center;">
                  <input id="walletSendAmount" type="number" step="0.00000001" value="0" style="width:160px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                  <button id="walletSendKasBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(135deg,var(--kaspa-accent) 0%,var(--kaspa-primary) 100%);color:#03181a;font-weight:900;">Send</button>
                </div>
                <div style="margin-top:10px;font-size:12px;color:var(--text-muted);word-break:break-all;">
                  <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;">
                    <div style="min-width:0;flex:1;"><span style="opacity:0.85;">TXID:</span> <span id="walletSendKasTxid">—</span></div>
                    <button id="walletCopySendKasTxidBtn" class="copyBtn" type="button">Copy</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="collapseCard card" style="grid-column: 1 / -1;">
              <input id="walletTxHistoryCardToggle" class="collapseToggle" type="checkbox" checked />
              <div class="collapseHeader">
                <label class="collapseTitle" for="walletTxHistoryCardToggle">Transaction History</label>
                <div class="collapseActions">
                  <button id="walletTxRefreshBtn" style="cursor:pointer;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.20);color:var(--text);font-weight:800;">Refresh</button>
                  <label class="collapseChevron" for="walletTxHistoryCardToggle" aria-label="Toggle"></label>
                </div>
              </div>
              <div class="collapseBody">
                <div id="walletTxHistoryStatus" style="font-size:12px;color:var(--text-muted);">—</div>
                <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                  <div>
                    <div style="font-weight:850;margin-bottom:8px;">Received</div>
                    <div id="walletTxReceivedList" class="txList"></div>
                  </div>
                  <div>
                    <div style="font-weight:850;margin-bottom:8px;">Sent</div>
                    <div id="walletTxSentList" class="txList"></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="collapseCard card" style="grid-column: 1 / -1;">
              <input id="walletAccountCardToggle" class="collapseToggle" type="checkbox" checked />
              <div class="collapseHeader">
                <label class="collapseTitle" for="walletAccountCardToggle">Account</label>
                <div class="collapseActions">
                  <button id="walletDeriveBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Refresh address</button>
                  <label class="collapseChevron" for="walletAccountCardToggle" aria-label="Toggle"></label>
                </div>
              </div>
              <div class="collapseBody">
                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
                  <label style="font-size:12px;color:var(--text-muted);">Network</label>
                  <select id="walletNetwork" style="padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);">
                    <option value="mainnet">mainnet</option>
                    <option value="testnet">testnet</option>
                    <option value="devnet">devnet</option>
                  </select>
                  <label style="font-size:12px;color:var(--text-muted);">RPC</label>
                  <input id="walletRpcUrl" type="text" value="grpc://127.0.0.1:16110" spellcheck="false" style="flex:1;min-width:220px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                </div>

                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:10px;">
                  <label style="font-size:12px;color:var(--text-muted);">Base</label>
                  <input id="walletBasePath" type="text" value="m/44'/111111'/0'" spellcheck="false" style="flex:1;min-width:240px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                </div>

                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:10px;">
                  <label style="font-size:12px;color:var(--text-muted);">Chain</label>
                  <select id="walletChain" style="padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);">
                    <option value="0">receive</option>
                    <option value="1">change</option>
                  </select>
                  <label style="font-size:12px;color:var(--text-muted);">Index</label>
                  <input id="walletAddrIndex" type="number" value="0" min="0" step="1" style="width:110px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="walletManagePanel" style="display:none;margin-top:14px;">

        <div class="walletGrid" style="margin-top:14px;">
          <div class="collapseCard card">
            <input id="walletManageCreateToggle" class="collapseToggle" type="checkbox" checked />
            <div class="collapseHeader">
              <label class="collapseTitle" for="walletManageCreateToggle">Create profile (new mnemonic)</label>
              <div class="collapseActions">
                <label class="collapseChevron" for="walletManageCreateToggle" aria-label="Toggle"></label>
              </div>
            </div>
            <div class="collapseBody">
              <div style="display:flex;gap:10px;flex-wrap:wrap;">
                <input id="walletNewUsername" type="text" placeholder="Username" spellcheck="false" style="flex:1;min-width:180px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                <input id="walletNewPassword" type="password" placeholder="Password" autocomplete="off" style="flex:1;min-width:180px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                <select id="walletWordCount" style="width:96px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);">
                  <option value="24">24</option>
                  <option value="12">12</option>
                </select>
                <button id="walletCreateBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(135deg,var(--kaspa-accent) 0%,var(--kaspa-primary) 100%);color:#03181a;font-weight:900;">Create</button>
              </div>
              <div style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">This will show a mnemonic once. Save it securely.</div>
            </div>
          </div>

          <div class="collapseCard card">
            <input id="walletManageImportToggle" class="collapseToggle" type="checkbox" checked />
            <div class="collapseHeader">
              <label class="collapseTitle" for="walletManageImportToggle">Import profile</label>
              <div class="collapseActions">
                <label class="collapseChevron" for="walletManageImportToggle" aria-label="Toggle"></label>
              </div>
            </div>
            <div class="collapseBody">
              <div style="display:flex;gap:10px;flex-wrap:wrap;">
                <input id="walletImportUsername" type="text" placeholder="Username" spellcheck="false" style="flex:1;min-width:180px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                <input id="walletImportPassword" type="password" placeholder="Password" autocomplete="off" style="flex:1;min-width:180px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
              </div>

              <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                <div>
                  <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Mnemonic (12/24 words)</label>
                  <textarea id="walletImportMnemonic" rows="3" spellcheck="false" style="width:100%;resize:vertical;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);"></textarea>
                  <div style="display:flex;gap:10px;margin-top:8px;flex-wrap:wrap;">
                    <input id="walletMnemonicPass" type="password" placeholder="Mnemonic passphrase (optional)" autocomplete="off" style="flex:1;min-width:220px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    <button id="walletImportMnemonicBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Import mnemonic</button>
                  </div>
                </div>
                <div>
                  <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Private key (hex)</label>
                  <textarea id="walletImportPrivKey" rows="3" spellcheck="false" style="width:100%;resize:vertical;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);"></textarea>
                  <div style="display:flex;justify-content:flex-end;margin-top:8px;">
                    <button id="walletImportPrivKeyBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Import private key</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="collapseCard card" style="grid-column: 1 / -1;">
            <input id="walletManageDataToggle" class="collapseToggle" type="checkbox" checked />
            <div class="collapseHeader">
              <label class="collapseTitle" for="walletManageDataToggle">Wallet data</label>
              <div class="collapseActions">
                <label class="collapseChevron" for="walletManageDataToggle" aria-label="Toggle"></label>
              </div>
            </div>
            <div class="collapseBody">
              <div style="display:flex;gap:10px;flex-wrap:wrap;">
                <button id="walletDeleteProfileBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Delete selected profile</button>
                <button id="walletClearAllProfilesBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid rgba(255, 120, 120, 0.35);background:rgba(255, 80, 80, 0.12);color:var(--text);font-weight:950;">Clear ALL wallet data</button>
              </div>
              <div style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">These actions remove saved wallet profiles (usernames/accounts) from this device.</div>
            </div>
          </div>
        </div>

        </div>

        <div id="walletAdvancedPanel" style="display:none;margin-top:14px;">
          <div class="walletGrid">
            <div class="collapseCard card">
              <input id="walletAdvancedDebugToggle" class="collapseToggle" type="checkbox" checked />
              <div class="collapseHeader">
                <label class="collapseTitle" for="walletAdvancedDebugToggle">Debug</label>
                <div class="collapseActions">
                  <label class="collapseChevron" for="walletAdvancedDebugToggle" aria-label="Toggle"></label>
                </div>
              </div>
              <div class="collapseBody">
                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
                  <button id="walletDebugBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Fingerprint</button>
                  <div style="font-size:12px;color:var(--text-muted);word-break:break-all;" id="walletDebugOut">—</div>
                </div>
              </div>
            </div>
          </div>
        </div>
              </section>
            </section>

            <section id="pageImport" class="page">
              <section class="card">
                <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
                  <div style="font-weight:800;">Import</div>
                </div>

                <div style="margin-top:14px;">
                  <div class="collapseCard card">
                    <input id="importNodeToolsToggle" class="collapseToggle" type="checkbox" checked />
                    <div class="collapseHeader">
                      <label class="collapseTitle" for="importNodeToolsToggle">Import node tools</label>
                      <div class="collapseActions">
                        <label class="collapseChevron" for="importNodeToolsToggle" aria-label="Toggle"></label>
                      </div>
                    </div>
                    <div class="collapseBody">
                      <div style="font-size:12px;color:var(--text-muted);line-height:1.35;">Select the folder containing <span style="font-weight:850;">kaspad.exe</span>, <span style="font-weight:850;">stratum-bridge.exe</span>, and <span style="font-weight:850;">config.yaml</span>.</div>
                      <div style="margin-top:10px;font-size:12px;color:var(--text-muted);word-break:break-all;">Current: <span id="nodeBundleDirOut">—</span></div>
                      <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
                        <button id="nodeBundleImportBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Import</button>
                        <button id="nodeBundleOpenBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Open folder</button>
                        <button id="nodeBundleClearBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid rgba(255, 120, 120, 0.35);background:rgba(255, 80, 80, 0.12);color:var(--text);font-weight:900;">Clear</button>
                      </div>
                    </div>
                  </div>
                </div>
              </section>
            </section>

            <section id="pageStudio" class="page">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;">
                <div class="tabs">
                  <button id="studioTabAudio" class="tabBtn tabBtnActive" type="button">Audio</button>
                  <button id="studioTabVideo" class="tabBtn" type="button">Video</button>
                </div>
              </div>

              <div id="studioAudioPanel" class="card">
                <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;">
                  <div style="font-weight:800;">Audio Recorder</div>
                  <div class="pill" style="display:flex;align-items:center;gap:10px;">
                    <span style="font-weight:850;">Status</span>
                    <span id="studioAudioStatus" style="color:var(--text-muted);">Idle</span>
                  </div>
                </div>

                <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:14px;">
                  <div>
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Microphone</label>
                    <select id="studioAudioMic" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);"></select>
                    <div style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">Choose an input device, then record.</div>
                  </div>
                  <div>
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Send settings</label>
                    <input id="studioAudioPriv" type="password" placeholder="From private key (hex)" autocomplete="off" spellcheck="false" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    <div id="studioAudioPrivAutoHint" style="display:none;margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">Wallet synced (Signing automatically)</div>
                    <div style="margin-top:10px;display:flex;gap:10px;">
                      <input id="studioAudioTo" type="text" placeholder="To address" spellcheck="false" style="flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    </div>
                    <div id="studioAudioToResolved" class="knsPreview" style="display:none;"></div>
                    <div style="margin-top:10px;display:flex;gap:10px;align-items:center;">
                      <input id="studioAudioAmount" type="number" step="0.00000001" value="0" style="width:160px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                      <input id="studioAudioRpc" type="text" value="grpc://127.0.0.1:16110" style="flex:1;min-width:220px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    </div>
                  </div>
                </div>

                <div style="margin-top:10px;height:1px;background:rgba(112, 199, 186, 0.14);"></div>

                <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
                  <button id="studioAudioStart" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(135deg,var(--kaspa-accent) 0%,var(--kaspa-primary) 100%);color:#03181a;font-weight:900;">Record</button>
                  <button id="studioAudioStop" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Stop</button>
                  <button id="studioAudioDelete" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid rgba(255, 120, 120, 0.35);background:rgba(255, 80, 80, 0.12);color:var(--text);font-weight:950;">Delete take</button>
                  <div style="flex:1;"></div>
                  <button id="studioAudioSave" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Save</button>
                  <button id="studioAudioExportMp3" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Export MP3</button>
                  <button id="studioAudioExportWav" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Export WAV</button>
                  <button id="studioAudioSend" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:950;">Send</button>
                </div>

                <div style="margin-top:10px;">
                  <audio id="studioAudioPlayback" controls style="width:100%;display:none;"></audio>
                  <div id="studioAudioMeta" style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;display:none;"></div>
                </div>
              </div>

              <div id="studioVideoPanel" class="card" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;">
                  <div style="font-weight:800;">Video Recorder</div>
                  <div class="pill" style="display:flex;align-items:center;gap:10px;">
                    <span style="font-weight:850;">Status</span>
                    <span id="studioVideoStatus" style="color:var(--text-muted);">Idle</span>
                  </div>
                </div>

                <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:14px;">
                  <div>
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Video source</label>
                    <select id="studioVideoSource" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);">
                      <option value="camera">Camera</option>
                      <option value="screen">Screen</option>
                    </select>
                    <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                      <div>
                        <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Camera</label>
                        <select id="studioVideoCam" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);"></select>
                      </div>
                      <div>
                        <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Microphone</label>
                        <select id="studioVideoMic" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);"></select>
                      </div>
                    </div>
                  </div>
                  <div>
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Send settings</label>
                    <input id="studioVideoPriv" type="password" placeholder="From private key (hex)" autocomplete="off" spellcheck="false" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    <div id="studioVideoPrivAutoHint" style="display:none;margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">Wallet synced (Signing automatically)</div>
                    <div style="margin-top:10px;display:flex;gap:10px;">
                      <input id="studioVideoTo" type="text" placeholder="To address" spellcheck="false" style="flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    </div>
                    <div id="studioVideoToResolved" class="knsPreview" style="display:none;"></div>
                    <div style="margin-top:10px;display:flex;gap:10px;align-items:center;">
                      <input id="studioVideoAmount" type="number" step="0.00000001" value="0" style="width:160px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                      <input id="studioVideoRpc" type="text" value="grpc://127.0.0.1:16110" style="flex:1;min-width:220px;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    </div>
                  </div>
                </div>

                <div style="margin-top:10px;">
                  <div style="font-weight:750;margin-bottom:8px;">Preview</div>
                  <video id="studioVideoLive" autoplay muted playsinline style="width:100%;border-radius:12px;border:1px solid rgba(112, 199, 186, 0.18);background:rgba(15,21,30,0.35);display:none;"></video>
                  <video id="studioVideoPlayback" controls playsinline style="width:100%;border-radius:12px;border:1px solid rgba(112, 199, 186, 0.18);background:rgba(15,21,30,0.35);display:none;"></video>
                  <div id="studioVideoMeta" style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;display:none;"></div>
                </div>

                <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
                  <button id="studioVideoStart" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(135deg,var(--kaspa-accent) 0%,var(--kaspa-primary) 100%);color:#03181a;font-weight:900;">Record</button>
                  <button id="studioVideoStop" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Stop</button>
                  <button id="studioVideoDelete" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid rgba(255, 120, 120, 0.35);background:rgba(255, 80, 80, 0.12);color:var(--text);font-weight:950;">Delete take</button>
                  <div style="flex:1;"></div>
                  <button id="studioVideoSave" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Save</button>
                  <button id="studioVideoExportMp4" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:900;">Export MP4</button>
                  <button id="studioVideoSend" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:950;">Send</button>
                </div>
              </div>
            </section>

            <section id="pageTransfer" class="page pageActive">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;">
                <div class="tabs">
                  <button id="tabSend" class="tabBtn tabBtnActive" type="button">Send</button>
                  <button id="tabReceive" class="tabBtn" type="button">Receive</button>
                </div>
              </div>

              <div id="transferSendPanel" class="card">
                <div style="font-weight:800;margin-bottom:10px;">Send</div>

                <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">File</label>
                <div id="sendDropZone" class="dropZone">
                  <input id="sendFile" type="file" style="width:100%;" />
                  <div class="dropHint" id="sendFileHint">Tip: drag & drop a file here.</div>
                </div>

                <div style="height:10px;"></div>

                <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">From private key (hex)</label>
                <input id="sendPriv" type="password" autocomplete="off" spellcheck="false" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                <div id="sendPrivAutoHint" style="display:none;margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">Wallet synced (Signing automatically)</div>

                <div style="height:10px;"></div>

                <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">To address</label>
                <input id="sendTo" type="text" spellcheck="false" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                <div id="sendToResolved" class="knsPreview" style="display:none;"></div>

                <div style="display:flex;gap:10px;margin-top:10px;">
                  <div style="flex:1;">
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Amount (KAS)</label>
                    <input id="sendAmount" type="number" step="0.00000001" value="0" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                  </div>
                  <div style="flex:1;">
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">RPC URL</label>
                    <input id="sendRpc" type="text" value="grpc://127.0.0.1:16110" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                  </div>
                </div>

                <div class="progressRow">
                  <button id="sendBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(135deg,var(--kaspa-accent) 0%,var(--kaspa-primary) 100%);color:#03181a;font-weight:800;">Send</button>
                  <div class="progressRing">
                    <svg class="ring" viewBox="0 0 44 44" aria-hidden="true">
                      <circle class="ring-bg" cx="22" cy="22" r="18"></circle>
                      <circle class="ring-fg" id="sendRing" cx="22" cy="22" r="18"></circle>
                    </svg>
                    <div class="ringText">
                      <div class="ringTitle">Progress</div>
                      <div class="ringValue" id="sendProgress">Idle</div>
                    </div>
                  </div>
                </div>

                <div style="margin-top:10px;font-size:12px;color:var(--text-muted);word-break:break-all;">
                  <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;">
                    <div style="min-width:0;flex:1;"><span style="opacity:0.85;">TXID:</span> <span id="sendTxid">—</span></div>
                    <button id="sendCopyTxidBtn" class="copyBtn" type="button">Copy</button>
                  </div>
                  <div style="margin-top:6px;">
                    <a class="link" href="#" id="sendExplorerLink">Open in Explorer</a>
                  </div>
                </div>
              </div>

              <div id="transferReceivePanel" class="card" style="display:none;">
                <div style="font-weight:800;margin-bottom:10px;">Receive</div>

                <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Transaction ID (manifest txid)</label>
                <input id="recvTx" type="text" spellcheck="false" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                <div style="margin-top:8px;display:flex;justify-content:flex-end;">
                  <button id="recvCopyTxBtn" class="copyBtn" type="button">Copy</button>
                </div>

                <div style="display:flex;gap:10px;margin-top:10px;">
                  <div style="flex:1;">
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Start block hash (scan anchor)</label>
                    <input id="recvStart" type="text" spellcheck="false" placeholder="Optional" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                    <div style="margin-top:8px;display:flex;justify-content:flex-end;">
                      <button id="recvCopyStartBtn" class="copyBtn" type="button">Copy</button>
                    </div>
                    <div style="margin-top:6px;font-size:11px;color:var(--text-muted);line-height:1.35;">
                      <a class="link" href="#" id="explorerTip">Explorer: copy the first “Block hashes” value</a>
                    </div>
                  </div>
                  <div style="flex:1;">
                    <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">RPC URL</label>
                    <input id="recvRpc" type="text" value="grpc://127.0.0.1:16110" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />
                  </div>
                </div>

                <div style="height:10px;"></div>

                <label style="display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;">Save as</label>
                <input id="recvOut" type="text" value="received.bin" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);" />

                <div class="progressRow">
                  <button id="recvBtn" style="cursor:pointer;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:800;">Receive</button>
                  <div class="progressRing">
                    <svg class="ring" viewBox="0 0 44 44" aria-hidden="true">
                      <circle class="ring-bg" cx="22" cy="22" r="18"></circle>
                      <circle class="ring-fg" id="recvRing" cx="22" cy="22" r="18"></circle>
                    </svg>
                    <div class="ringText">
                      <div class="ringTitle">Progress</div>
                      <div class="ringValue" id="recvStatus">Idle</div>
                    </div>
                  </div>
                </div>

                <div style="margin-top:10px;display:flex;gap:10px;">
                  <button id="openBtn" style="cursor:pointer;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:700;">Open</button>
                  <button id="revealBtn" style="cursor:pointer;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:rgba(15,21,30,0.55);color:var(--text);font-weight:700;">Reveal</button>
                </div>
              </div>
            </section>
          </div>
      </div>
    </main>

    <div class="modalOverlay" id="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal">
        <div class="modalHeader">
          <div class="modalTitle" id="modalTitle">Notification</div>
          <button class="modalClose" id="modalClose" type="button">Close</button>
        </div>
        <div class="modalBody" id="modalBody"></div>
        <div class="modalActions" id="modalActions"></div>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
      (function () {
        const navTransfer = document.getElementById("navTransfer");
        const navWallet = document.getElementById("navWallet");
        const navImport = document.getElementById("navImport");
        const navStudio = document.getElementById("navStudio");

        const pageTransfer = document.getElementById("pageTransfer");
        const pageWallet = document.getElementById("pageWallet");
        const pageImport = document.getElementById("pageImport");
        const pageStudio = document.getElementById("pageStudio");

        const pageTitle = document.getElementById("pageTitle");
        const status = document.getElementById("status");

        if (!navTransfer || !navWallet || !navImport || !navStudio) return;
        if (!pageTransfer || !pageWallet || !pageImport || !pageStudio) return;

        const setActive = (name) => {
          const isTransfer = name === "transfer";
          const isWallet = name === "wallet";
          const isImport = name === "import";
          const isStudio = name === "studio";

          pageTransfer.className = `page ${isTransfer ? "pageActive" : ""}`.trim();
          pageWallet.className = `page ${isWallet ? "pageActive" : ""}`.trim();
          pageImport.className = `page ${isImport ? "pageActive" : ""}`.trim();
          pageStudio.className = `page ${isStudio ? "pageActive" : ""}`.trim();

          navTransfer.className = `navBtn ${isTransfer ? "navBtnActive" : ""}`.trim();
          navWallet.className = `navBtn ${isWallet ? "navBtnActive" : ""}`.trim();
          navImport.className = `navBtn ${isImport ? "navBtnActive" : ""}`.trim();
          navStudio.className = `navBtn ${isStudio ? "navBtnActive" : ""}`.trim();

          if (pageTitle) pageTitle.textContent = isTransfer ? "Transfer" : isWallet ? "Wallet" : isImport ? "Import" : "Studio";
          if (status) {
            status.textContent =
              isTransfer
                ? "Send or receive a file using your local Kaspa node RPC."
                : isWallet
                  ? "Manage your wallet, balance, and transactions."
                  : isImport
                    ? "Import node tools and configure local components."
                    : "Record and send audio/video. Use wallet sync for automatic signing.";
          }
        };

        const intercept = (name) => (e) => {
          try {
            e.preventDefault();
            e.stopImmediatePropagation();
            e.stopPropagation();
          } catch (_) {}
          setActive(name);
        };

        navTransfer.addEventListener("click", intercept("transfer"), true);
        navWallet.addEventListener("click", intercept("wallet"), true);
        navImport.addEventListener("click", intercept("import"), true);
        navStudio.addEventListener("click", intercept("studio"), true);
      })();
    </script>
  </body>
</html>
